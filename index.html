<!DOCTYPE html>
<html class="writer-html5" lang="en">
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.19: https://docutils.sourceforge.io/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Just Relax It &mdash; Relaxit  documentation</title>
      <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
      <link rel="stylesheet" type="text/css" href="_static/css/theme.css" />
      <link rel="stylesheet" type="text/css" href="_static/graphviz.css" />

  
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/_sphinx_javascript_frameworks_compat.js"></script>
        <script src="_static/doctools.js"></script>
        <script src="_static/sphinx_highlight.js"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Installation" href="installation.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="#" class="icon icon-home">
            Relaxit
          </a>
              <div class="version">
                0.1.0
              </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Guidelines</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="installation.html">Installation</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Code</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="distributions.html">Distributions</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="#">Relaxit</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="#" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">Just Relax It</li>
      <li class="wy-breadcrumbs-aside">
              <!-- User defined GitHub URL -->
              <a href="https://github.com/intsystems/discrete-variables-relaxation" class="fa fa-github"> Edit on GitHub</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="just-relax-it">
<h1>Just Relax It<a class="headerlink" href="#just-relax-it" title="Permalink to this heading"></a></h1>
<p>“Just Relax It” is a cutting-edge Python library designed to streamline the optimization of discrete probability distributions in neural networks, offering a suite of advanced relaxation techniques compatible with PyTorch.</p>
<dl class="simple">
<dt>&lt;div align=”center”&gt;</dt><dd><p>&lt;img src=”assets/logo.svg” width=”200px” /&gt;
&lt;h1&gt; Just Relax It &lt;/h1&gt;
&lt;p align=”center”&gt; Discrete Variables Relaxation &lt;/p&gt;</p>
</dd>
</dl>
<p>&lt;/div&gt;</p>
<dl>
<dt>&lt;p align=”center”&gt;</dt><dd><dl class="simple">
<dt>&lt;a href=”<a class="reference external" href="https://pytorch.org/docs/stable/distributions.html">https://pytorch.org/docs/stable/distributions.html</a>”&gt;</dt><dd><p>&lt;img alt=”Compatible with PyTorch” src=”<a class="reference external" href="https://img.shields.io/badge/Compatible_with_Pytorch-ef4c2c">https://img.shields.io/badge/Compatible_with_Pytorch-ef4c2c</a>”&gt;</p>
</dd>
</dl>
<p>&lt;/a&gt;
&lt;a href=”<a class="reference external" href="https://docs.pyro.ai/en/dev/distributions.html">https://docs.pyro.ai/en/dev/distributions.html</a>”&gt;</p>
<blockquote>
<div><p>&lt;img alt=”Inspired by Pyro” src=”<a class="reference external" href="https://img.shields.io/badge/Inspired_by_Pyro-fecd08">https://img.shields.io/badge/Inspired_by_Pyro-fecd08</a>”&gt;</p>
</div></blockquote>
<p>&lt;/a&gt;</p>
</dd>
</dl>
<p>&lt;/p&gt;</p>
<dl>
<dt>&lt;p align=”center”&gt;</dt><dd><dl class="simple">
<dt>&lt;a href=”<a class="reference external" href="https://github.com/intsystems/discrete-variables-relaxation/tree/main/tests">https://github.com/intsystems/discrete-variables-relaxation/tree/main/tests</a>”&gt;</dt><dd><p>&lt;img alt=”Coverage_2” src=”<a class="reference external" href="https://github.com/intsystems/discrete-variables-relaxation/actions/workflows/test.yml/badge.svg">https://github.com/intsystems/discrete-variables-relaxation/actions/workflows/test.yml/badge.svg</a>” /&gt;</p>
</dd>
</dl>
<p>&lt;/a&gt;
&lt;a href=”<a class="reference external" href="https://github.com/intsystems/discrete-variables-relaxation/tree/main/tests">https://github.com/intsystems/discrete-variables-relaxation/tree/main/tests</a>”&gt;</p>
<blockquote>
<div><p>&lt;img alt=”Coverage” src=”coverage-badge.svg” /&gt;</p>
</div></blockquote>
<p>&lt;/a&gt;
&lt;a href=”<a class="reference external" href="https://intsystems.github.io/discrete-variables-relaxation">https://intsystems.github.io/discrete-variables-relaxation</a>”&gt;</p>
<blockquote>
<div><p>&lt;img alt=”Docs” src=”<a class="reference external" href="https://github.com/intsystems/discrete-variables-relaxation/actions/workflows/docs.yml/badge.svg">https://github.com/intsystems/discrete-variables-relaxation/actions/workflows/docs.yml/badge.svg</a>” /&gt;</p>
</div></blockquote>
<p>&lt;/a&gt;</p>
</dd>
</dl>
<p>&lt;/p&gt;</p>
<dl>
<dt>&lt;p align=”center”&gt;</dt><dd><dl class="simple">
<dt>&lt;a href=”<a class="reference external" href="https://github.com/intsystems/discrete-variables-relaxation/blob/main/LICENSE">https://github.com/intsystems/discrete-variables-relaxation/blob/main/LICENSE</a>”&gt;</dt><dd><p>&lt;img alt=”License” src=”<a class="reference external" href="https://badgen.net/github/license/intsystems/discrete-variables-relaxation?color=green">https://badgen.net/github/license/intsystems/discrete-variables-relaxation?color=green</a>” /&gt;</p>
</dd>
</dl>
<p>&lt;/a&gt;
&lt;a href=”<a class="reference external" href="https://github.com/intsystems/discrete-variables-relaxation/graphs/contributors">https://github.com/intsystems/discrete-variables-relaxation/graphs/contributors</a>”&gt;</p>
<blockquote>
<div><p>&lt;img alt=”GitHub Contributors” src=”<a class="reference external" href="https://img.shields.io/github/contributors/intsystems/discrete-variables-relaxation">https://img.shields.io/github/contributors/intsystems/discrete-variables-relaxation</a>” /&gt;</p>
</div></blockquote>
<p>&lt;/a&gt;
&lt;a href=”<a class="reference external" href="https://github.com/intsystems/discrete-variables-relaxation/issues">https://github.com/intsystems/discrete-variables-relaxation/issues</a>”&gt;</p>
<blockquote>
<div><p>&lt;img alt=”Issues” src=”<a class="reference external" href="https://img.shields.io/github/issues-closed/intsystems/discrete-variables-relaxation?color=0088ff">https://img.shields.io/github/issues-closed/intsystems/discrete-variables-relaxation?color=0088ff</a>” /&gt;</p>
</div></blockquote>
<p>&lt;/a&gt;
&lt;a href=”<a class="reference external" href="https://github.com/intsystems/discrete-variables-relaxation/pulls">https://github.com/intsystems/discrete-variables-relaxation/pulls</a>”&gt;</p>
<blockquote>
<div><p>&lt;img alt=”GitHub Pull Requests” src=”<a class="reference external" href="https://img.shields.io/github/issues-pr-closed/intsystems/discrete-variables-relaxation?color=7f29d6">https://img.shields.io/github/issues-pr-closed/intsystems/discrete-variables-relaxation?color=7f29d6</a>” /&gt;</p>
</div></blockquote>
<p>&lt;/a&gt;</p>
</dd>
</dl>
<p>&lt;/p&gt;</p>
<p>“Just Relax It” is a cutting-edge Python library designed to streamline the optimization of discrete probability distributions in neural networks, offering a suite of advanced relaxation techniques compatible with PyTorch.</p>
<p>## 📬 Assets</p>
<ol class="arabic simple">
<li><p>[Technical Meeting 1 - Presentation](<a class="reference external" href="https://github.com/intsystems/discrete-variables-relaxation/blob/main/assets/presentation_tm1.pdf">https://github.com/intsystems/discrete-variables-relaxation/blob/main/assets/presentation_tm1.pdf</a>)</p></li>
<li><p>[Technical Meeting 2 - Jupyter Notebook](<a class="reference external" href="https://github.com/intsystems/discrete-variables-relaxation/blob/main/basic/basic_code.ipynb">https://github.com/intsystems/discrete-variables-relaxation/blob/main/basic/basic_code.ipynb</a>)</p></li>
<li><p>[Technical Meeting 3 - Jupyter Notebook](<a class="reference external" href="https://github.com/intsystems/discrete-variables-relaxation/blob/main/demo/vizualization.ipynb">https://github.com/intsystems/discrete-variables-relaxation/blob/main/demo/vizualization.ipynb</a>)</p></li>
<li><p>[Blog Post](<a class="reference external" href="https://github.com/intsystems/discrete-variables-relaxation/blob/main/assets/blog-post.pdf">https://github.com/intsystems/discrete-variables-relaxation/blob/main/assets/blog-post.pdf</a>)</p></li>
<li><p>[Documentation](<a class="reference external" href="https://intsystems.github.io/discrete-variables-relaxation/train.html">https://intsystems.github.io/discrete-variables-relaxation/train.html</a>)</p></li>
<li><p>[Tests](<a class="reference external" href="https://github.com/intsystems/discrete-variables-relaxation/tree/main/tests">https://github.com/intsystems/discrete-variables-relaxation/tree/main/tests</a>)</p></li>
</ol>
<p>## 💡 Motivation
For lots of mathematical problems we need an ability to sample discrete random variables.
The problem is that due to continuos nature of deep learning optimization, the usage of truely discrete random variables is infeasible.
Thus we use different relaxation method.
One of them, [Concrete distribution](<a class="reference external" href="https://arxiv.org/abs/1611.00712">https://arxiv.org/abs/1611.00712</a>) or [Gumbel-Softmax](<a class="reference external" href="https://arxiv.org/abs/1611.01144">https://arxiv.org/abs/1611.01144</a>) (this is one distribution proposed in parallel by two research groups) is implemented in different DL packages.
In this project we implement different alternatives to it.
&lt;div align=”center”&gt;</p>
<blockquote>
<div><p>&lt;img src=”assets/overview.png” width=”600”/&gt;</p>
</div></blockquote>
<p>&lt;/div&gt;</p>
<p>## 🗃 Algorithms
- [x] [Relaxed Bernoulli](<a class="reference external" href="https://github.com/intsystems/discrete-variables-relaxation/blob/main/src/relaxit/distributions/GaussianRelaxedBernoulli.py">https://github.com/intsystems/discrete-variables-relaxation/blob/main/src/relaxit/distributions/GaussianRelaxedBernoulli.py</a>), also see [📝 paper](<a class="reference external" href="http://proceedings.mlr.press/v119/yamada20a/yamada20a.pdf">http://proceedings.mlr.press/v119/yamada20a/yamada20a.pdf</a>)
- [x] [Correlated relaxed Bernoulli](<a class="reference external" href="https://github.com/intsystems/discrete-variables-relaxation/blob/main/src/relaxit/distributions/CorrelatedRelaxedBernoulli.py">https://github.com/intsystems/discrete-variables-relaxation/blob/main/src/relaxit/distributions/CorrelatedRelaxedBernoulli.py</a>), also see [📝 paper](<a class="reference external" href="https://openreview.net/pdf?id=oDFvtxzPOx">https://openreview.net/pdf?id=oDFvtxzPOx</a>)
- [x] [Gumbel-softmax TOP-K](<a class="reference external" href="https://github.com/intsystems/discrete-variables-relaxation/blob/main/src/relaxit/distributions/GumbelSoftmaxTopK.py">https://github.com/intsystems/discrete-variables-relaxation/blob/main/src/relaxit/distributions/GumbelSoftmaxTopK.py</a>), also see [📝 paper](<a class="reference external" href="https://arxiv.org/pdf/1903.06059">https://arxiv.org/pdf/1903.06059</a>)
- [x] [Straight-Through Bernoulli](<a class="reference external" href="https://github.com/intsystems/discrete-variables-relaxation/blob/main/src/relaxit/distributions/StraightThroughBernoulli.py">https://github.com/intsystems/discrete-variables-relaxation/blob/main/src/relaxit/distributions/StraightThroughBernoulli.py</a>), also see [📝 paper](<a class="reference external" href="https://citeseerx.ist.psu.edu/document?repid=rep1&amp;type=pdf&amp;doi=62c76ca0b2790c34e85ba1cce09d47be317c7235">https://citeseerx.ist.psu.edu/document?repid=rep1&amp;type=pdf&amp;doi=62c76ca0b2790c34e85ba1cce09d47be317c7235</a>)
- [x] [Invertible Gaussian](<a class="reference external" href="https://github.com/intsystems/discrete-variables-relaxation/blob/main/src/relaxit/distributions/InvertibleGaussian.py">https://github.com/intsystems/discrete-variables-relaxation/blob/main/src/relaxit/distributions/InvertibleGaussian.py</a>) with [KL implemented](<a class="reference external" href="https://github.com/intsystems/discrete-variables-relaxation/blob/f398ebbbac703582de392bc33d89b55c6c99ea68/src/relaxit/distributions/kl.py#L7">https://github.com/intsystems/discrete-variables-relaxation/blob/f398ebbbac703582de392bc33d89b55c6c99ea68/src/relaxit/distributions/kl.py#L7</a>), also see [📝 paper](<a class="reference external" href="https://arxiv.org/abs/1912.09588">https://arxiv.org/abs/1912.09588</a>)
- [x] [Hard Concrete](<a class="reference external" href="https://github.com/intsystems/discrete-variables-relaxation/blob/main/src/relaxit/distributions/HardConcrete.py">https://github.com/intsystems/discrete-variables-relaxation/blob/main/src/relaxit/distributions/HardConcrete.py</a>), also see [📝 paper](<a class="reference external" href="https://arxiv.org/pdf/1712.01312">https://arxiv.org/pdf/1712.01312</a>)
- [x] [REINFORCE](<a class="reference external" href="https://github.com/intsystems/discrete-variables-relaxation/blob/main/src/relaxit/distributions/CorrelatedRelaxedBernoulli.py">https://github.com/intsystems/discrete-variables-relaxation/blob/main/src/relaxit/distributions/CorrelatedRelaxedBernoulli.py</a>), also see [📺 slides](<a class="reference external" href="http://www.cs.toronto.edu/~tingwuwang/REINFORCE.pdf">http://www.cs.toronto.edu/~tingwuwang/REINFORCE.pdf</a>)
- [x] [Logit-Normal](<a class="reference external" href="https://github.com/intsystems/discrete-variables-relaxation/blob/main/src/relaxit/distributions/LogisticNormalSoftmax.py">https://github.com/intsystems/discrete-variables-relaxation/blob/main/src/relaxit/distributions/LogisticNormalSoftmax.py</a>) and [Laplace-form approximation of Dirichlet](<a class="reference external" href="https://github.com/intsystems/discrete-variables-relaxation/blob/main/src/relaxit/distributions/approx.py">https://github.com/intsystems/discrete-variables-relaxation/blob/main/src/relaxit/distributions/approx.py</a>), also see [ℹ️ wiki](<a class="reference external" href="https://en.wikipedia.org/wiki/Logit-normal_distribution">https://en.wikipedia.org/wiki/Logit-normal_distribution</a>) and [💻 stackexchange](<a class="reference external" href="https://stats.stackexchange.com/questions/535560/approximating-the-logit-normal-by-dirichlet">https://stats.stackexchange.com/questions/535560/approximating-the-logit-normal-by-dirichlet</a>)</p>
<p>## 🎮 Demo
| Laplace Bridge | REINFORCE in Acrobot environment | VAE with discrete latents |
| :—: | :—: | :—: |
| ![Laplace Bridge](<a class="reference external" href="https://github.com/user-attachments/assets/ac5d5a71-e7d7-4ec3-b9ca-9b72d958eb41">https://github.com/user-attachments/assets/ac5d5a71-e7d7-4ec3-b9ca-9b72d958eb41</a>) | ![REINFORCE](<a class="reference external" href="https://gymnasium.farama.org/_images/acrobot.gif">https://gymnasium.farama.org/_images/acrobot.gif</a>) | ![VAE](<a class="reference external" href="https://github.com/user-attachments/assets/937585c4-df84-4ab0-a2b9-ea6a73997793">https://github.com/user-attachments/assets/937585c4-df84-4ab0-a2b9-ea6a73997793</a>) |
| [![Open In Colab](<a class="reference external" href="https://colab.research.google.com/assets/colab-badge.svg)](https://colab.research.google.com/github/intsystems/discrete-variables-relaxation/blob/main/demo/laplace-bridge.ipynb">https://colab.research.google.com/assets/colab-badge.svg)](https://colab.research.google.com/github/intsystems/discrete-variables-relaxation/blob/main/demo/laplace-bridge.ipynb</a>) | [![Open In Colab](<a class="reference external" href="https://colab.research.google.com/assets/colab-badge.svg)](https://colab.research.google.com/github/intsystems/discrete-variables-relaxation/blob/main/demo/reinforce.ipynb">https://colab.research.google.com/assets/colab-badge.svg)](https://colab.research.google.com/github/intsystems/discrete-variables-relaxation/blob/main/demo/reinforce.ipynb</a>) | [![Open In Colab](<a class="reference external" href="https://colab.research.google.com/assets/colab-badge.svg)](https://colab.research.google.com/github/intsystems/discrete-variables-relaxation/blob/main/demo/demo.ipynb">https://colab.research.google.com/assets/colab-badge.svg)](https://colab.research.google.com/github/intsystems/discrete-variables-relaxation/blob/main/demo/demo.ipynb</a>) |</p>
<p>For demonstration purposes, we divide our algorithms in three different groups. Each group relates to the particular demo code:
- [Laplace bridge between Dirichlet and LogisticNormal distributions](<a class="reference external" href="https://github.com/intsystems/discrete-variables-relaxation/blob/main/demo/laplace-bridge.ipynb">https://github.com/intsystems/discrete-variables-relaxation/blob/main/demo/laplace-bridge.ipynb</a>)
- [REINFORCE](<a class="reference external" href="https://github.com/intsystems/discrete-variables-relaxation/blob/main/demo/reinforce.ipynb">https://github.com/intsystems/discrete-variables-relaxation/blob/main/demo/reinforce.ipynb</a>)
- [Other relaxation methods](<a class="reference external" href="https://github.com/intsystems/discrete-variables-relaxation/blob/main/demo/demo.ipynb">https://github.com/intsystems/discrete-variables-relaxation/blob/main/demo/demo.ipynb</a>)</p>
<p>We describe our demo experiments [here](<a class="reference external" href="https://github.com/intsystems/discrete-variables-relaxation/tree/main/demo">https://github.com/intsystems/discrete-variables-relaxation/tree/main/demo</a>).</p>
<p>## 📚 Stack
Some of the alternatives for GS were implemented in [pyro](<a class="reference external" href="https://docs.pyro.ai/en/dev/distributions.html">https://docs.pyro.ai/en/dev/distributions.html</a>), so we base our library on their codebase.</p>
<p>## 🧩 Some details
To make to library consistent, we integrate imports of distributions from <cite>pyro</cite> and <cite>torch</cite> into the library, so that all the categorical distributions can be imported from one entrypoint.</p>
<p>## 👥 Contributors
- [Daniil Dorin](<a class="reference external" href="https://github.com/DorinDaniil">https://github.com/DorinDaniil</a>) (Basic code writing, Final demo, Algorithms)
- [Igor Ignashin](<a class="reference external" href="https://github.com/ThunderstormXX">https://github.com/ThunderstormXX</a>) (Project wrapping, Documentation writing, Algorithms)
- [Nikita Kiselev](<a class="reference external" href="https://github.com/kisnikser">https://github.com/kisnikser</a>) (Project planning, Blog post, Algorithms)
- [Andrey Veprikov](<a class="reference external" href="https://github.com/Vepricov">https://github.com/Vepricov</a>) (Tests writing, Documentation writing, Algorithms)
- You are welcome to contribute to our project!</p>
<p>## 🔗 Useful links
- [About top-k GS](<a class="reference external" href="https://uvadlc-notebooks.readthedocs.io/en/latest/tutorial_notebooks/DL2/sampling/subsets.html">https://uvadlc-notebooks.readthedocs.io/en/latest/tutorial_notebooks/DL2/sampling/subsets.html</a>)
- [VAE implementation with different latent distributions](<a class="reference external" href="https://github.com/kampta/pytorch-distributions">https://github.com/kampta/pytorch-distributions</a>)
- [KL divergence between Dirichlet and Logistic-Normal implemented in R](<a class="reference external" href="https://rdrr.io/cran/Compositional/src/R/kl.diri.normal.R">https://rdrr.io/cran/Compositional/src/R/kl.diri.normal.R</a>)
- [About score function (SF) and pathwise derivate (PD) estimators, VAE and REINFORCE](<a class="reference external" href="https://arxiv.org/abs/1506.05254">https://arxiv.org/abs/1506.05254</a>)</p>
<div class="toctree-wrapper compound">
<p class="caption" role="heading"><span class="caption-text">Guidelines</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="installation.html">Installation</a></li>
</ul>
</div>
<div class="toctree-wrapper compound">
<p class="caption" role="heading"><span class="caption-text">Code</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="distributions.html">Distributions</a></li>
</ul>
</div>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="installation.html" class="btn btn-neutral float-right" title="Installation" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2024, Daniil Dorin, Igor Ignashin, Nikita Kiselev, Andrey Veprikov.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>